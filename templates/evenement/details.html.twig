{% extends 'base.html.twig' %}


{% block body %}





<div class="containerEelmentsDetails">
    <div class="titleEvenement">
        <h1>{{ evenement.nom }}</h1>
    </div>
    <div class="disreption">
        <img src="{{asset ('images/evenement/'~ evenement.image) }}" alt="">

        <span>{{ evenement.description }} </span>
    </div>

    <div class="info">
        <strong>Référence : {{ createur.email }}</strong>
        <strong> du : {{ evenement.dateDebut | date('y-m-d H:i') }}</strong>
        <strong> au : {{ evenement.dateFin | date('y-m-d H:i') }} </strong>
    </div>
    
</div>
{% if evenement.createur == app.user %}
<a href="{{ path('supprimer_evenement',{'id':evenement.id}) }}"><i class="fa-solid fa-trash"></i></a>
{% endif %}


{# condition pour pas pouvoir participer un evenementPasses #}
{% if evenement.dateDebut | date('m/d/y') > "now"|date("m/d/Y") %}
    

{% if evenement.participant |length == evenement.nbDesPlaces %}
{% set link = 'complete' %}
{% elseif is_granted('IS_AUTHENTICATED_REMEMBERED') %}
{% set link = '<a href="' ~ path('add_participant', {'id': evenement.id}) ~ '">participer</a>' %}
{% for participant in evenement.participant %}
{% if participant.id == app.user.id %}
{% set link = 'vous etes inscrits' %}
{% endif %}
{% endfor %}
{% else %}
{% set link = '<a href="' ~ path('app_login') ~ '">Connectez-vous</a> pour participer' %}
{% endif %}

{{ link | raw}}
{% endif %}

<div class="espaceCommentaire">
    <strong>Laissez un commentaire :</strong>
    {% for message in app.flashes('success') %}
    {{ message }}
    {% endfor %}

    <div class="commentaires">

        {% for commentaire in commentaires %}
        <span>{{ commentaire.utilisateur.pseudo }}</span>
        <div class="cmmentaireEtSupprimer">
            <span class="commentaire"> {{ commentaire }} </span>
            {% if commentaire.utilisateur == app.user %}
            <a href="{{ path('supprimer_commentaire',{'id':commentaire.id})}}"><i class="fa-solid fa-trash"></i></a>
            <a
                href="{{ path('edit_commentaire',{'idEvent':commentaire.evenement.id ,'idCommentaire':commentaire.id})}}"><i
                    class="fa-sharp fa-solid fa-pen-to-square"></i></a>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <div class="ecrireUnCommentaire">
        {{form_start( formAddCommentaire) }}
        {{ form_row(formAddCommentaire.text, {'label': false,'attr': {'placeholder': 'Ajouter un commentaire'}})
        }}
        <span>
            {{form_row( formAddCommentaire.submit) }}
        </span>
        {{form_end( formAddCommentaire) }}
    </div>
</div>


{% if evenement.createur == app.user %}
    
<table>
    <tr>
        <th>Participants :</th>
    </tr>
    <tr>
        <th>Nom</th>
        <th>Email</th>
        <th>Date d'événement</th>
    </tr>
    {% for participant in evenement.participant %}
    <tr style="color: {{  couleurs[loop.index0 % couleurs|length]}}">
        <td>{{ participant.pseudo }}</td>
        <td><a href="mailto:{{ participant.email }}">{{ participant.email }}</a></td>
        <td>{{ evenement.dateDebut |date('Y-m-d') }}</td>
    </tr>
    {% endfor %}
</table>
{% endif %}




</div>

{% endblock %}